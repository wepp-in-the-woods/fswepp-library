<html>
 <head>
  <title>
   Enhancements to the CLIGEN Weather Generator for Mountainous or Custom Applications
  </title>
 </head>
 <body bgcolor=ivory vlink="darkgreen" vlink="darkgreen" alink="crimson">
  <font face="trebuchet, tahoma, sans serif">
  <table width=100% border=1>
   <tr bgcolor="&99cc99">
    <th><a href="https://www.fs.usda.gov">USDA Forest Service</a>
    <th><a href="https://www.fs.fed.us/rm/">Rocky Mountain Research Station</a>
    <th><a href="https://forest.moscowfsl.wsu.edu">Moscow FSL</a>
    <th><a href="https://forest.moscowfsl.wsu.edu/engr/">Soil and Water Engineering</a>
   </table>
   <table border=0 cellpadding="6" width="100%">
    <tr>
     <td><img src="../../rmrs_logo_sm.gif" border=0"></td>
     <td>
      <h3>Enhancements to the CLIGEN Weather Generator for Mountainous or Custom Applications</h3>
      <b>D. L. Scheele, W. J. Elliot, D. E. Hall</b>
     </td>
    </tr>
   </table>
   <p>
  <b>Abstract</b>
  <blockquote>
   The Water Erosion Prediction Project (WEPP) model is a state-of-the-art soil erosion model applicable to a
wide range of vegetation, soil, and climatic conditions. The CLIGEN weather generator is distributed with
WEPP. The CLIGEN database contained some errors in the data and did not include many climate stations in
mountainous areas where most forests are located and where climate is highly variable. Errors in the database
were identified and corrected. The database was expanded from 1,100 stations to more than 2,600. In addition,
the ability to modify the statistics for a climate station has been developed to allow users to enter their own
weather station statistics into a web-based computer interface. Users can enter specific values, change existing
values by a percentage, modify the annual amount, or adjust temperatures with elevation. The PRISM monthly
precipitation database was incorporated into the interface to aid users in predicting climates at remote sites. The
designated changes are made to an existing CLIGEN parameter file to generate a modified climate file. The
modified climate file may be selected for use with a Forest Service WEPP interface, or it may be used to
generate a climate file for use with the WEPP model. The enhancements can be accessed from a web site.
  </blockquote>
  <b>Keywords:</b> WEPP, CLIGEN, Climate generation, PRISM, Stochastic weather generator.
  <p>
  <b>Authors</b>
  <blockquote>
   <b>Dayna L. Scheele,</b> Civil Engineer, USDA Forest Service, Rocky Mountain Research Station, Moscow, Idaho.
   <br>
   <b>William J. Elliot,</b> Project Leader, USDA Forest Service, Rocky Mountain Research Station, Moscow, Idaho.
   <br>
   <b>David E. Hall,</b> Computer Specialist, USDA Forest Service, Rocky Mountain Research Station, Moscow, Idaho.
   <br>
  </blockquote>
  <hr>

<h3>Introduction</h3>
The single most important factor impacting soil erosion is weather. Weather is highly variable from year to
year, and site to site, particularly when the sites are at different elevations, or on opposite sides of a mountain
range. The better the weather can be predicted for a given site, the better will be the predicted erosion for that
site.
<p>
The Water Erosion Prediction Project (WEPP) model is a process-based soil erosion model developed to
replace the Universal Soil Loss Equation. WEPP requires a daily climate input to drive the plant growth,
hydrologic, and soil erosion routines (Flanagan and Livingston 1995). A daily stochastic weather generator,
CLIGEN, is packaged with WEPP. Accompanying CLIGEN is a database of weather statistics for about 1100
climates, one for every 60-mile grid across the U.S. (Nicks et al. 1995).
<p>
The 60-mile grid of climates was acceptable for areas in the central U.S. where there are minimal
differences in weather from one station to the next. In mountainous areas, however, the database was
inadequate. Precipitation and temperatures vary considerably with elevation and aspect. Most weather stations
in the CLIGEN database were located in valleys, and so gave unacceptably dry and warm climates for nearby
mountainous areas. WEPP users sometimes want to incorporate the weather at the remote site with records
from SNOTEL stations or data collected as part of other short-term studies.
<p>
Another problem with the CLIGEN generator was encountered during some WEPP runs in which a
generated climate file predicted more than 999.9 mm of precipitation in a single day, for a climate with an
annual precipitation of about 500 mm. The source of this error was a precipitation skew coefficient value that
was about 4 times the amount of most skew coefficients in the input statistics data set.
<p>
While the above problems were being identified, we were developing a new suite of Internet-based
interfaces for WEPP to help users predict soil erosion from roads, forests, and rangelands (Elliot et al. 2000).
Included with those interfaces was the need to develop a complementary climate generator interface.
<p>
In 1999, Oregon State University, in cooperation with the Natural Resource Conservation Service and
numerous state climatologists, released the PRISM database of monthly precipitation values for a 2.5 min
(4 km) grid covering the continental U.S. (Daly et al. 1997). The PRISM database, with monthly precipitation
estimates for more than 900,000 locations, could enhance the CLIGEN database.
<p>
The objectives of this paper are to:
  <ul>
   <li>Describe the corrections and improvements made to the CLIGEN database;</li>
   <li>Discuss the techniques and assumptions for allowing customization of the database;</li>
   <li>Describe accessing the PRISM database to aid in climate customization; and</li>
   <li>Describe the Internet interface technology.</li>
  </ul>
<h3>Corrections</h3>
CLIGEN generates a stochastic weather sequence from a set of climate statistics called parameter files, for
the station selected. The CLIGEN parameter files list monthly statistical values for precipitation, temperature,
dew point, solar radiation, and wind information. The parameter files were developed from five databases
containing summaries of weather station observations. Some of the fields in these five databases contained
errors that were transferred to the parameter files when they were generated. We corrected the errors in the
databases, added stations to the databases, and rebuilt the parameter files. In a comparison of the old and new
parameter files, we found that about ten percent of the parameter files had at least one major error that had been
corrected. The corrections include:
  <ul>
   <li>Changes to 16 station names;</li>
   <li>Corrections of 5 latitudes, 14 longitudes, and 33 elevations;</li>
   <li>Changes to 329 time to peak intensity mean values; and</li>
   <li>Changes to about 600 wind values, mostly from changes in one of the station summary files.</li>
  </ul>
Some were direct changes, some changed because different stations were used for interpolation, and some
changed due to changes in the program that created the CLIGEN parameter files. Many of the corrections made
were from comparisons of the CLIGEN weather station database to the 1991 station data inventory files
obtained from the Western Regional Climate Center website (WRCC 1991). The five CLIGEN weather
databases contained enough data to increase the number of CLIGEN stations from 1100 to about 2600, covering
the Continental U.S., Alaska, Hawaii, Pacific Islands, and the territory of Puerto Rico. Along with the
corrections and increased sites, a list was added to the end of each parameter file to report the stations used for
interpolation of values and their weighting factors.

<h3>Customization</h3>
Generally, users who wish to customize a climate have knowledge of mean precipitation or temperatures for
a given site. They seldom have enough information to develop values for standard deviation or skew statistics.
Hence, a technology was developed to allow users to customize the mean values for the site of interest, while
using the other statistics from the nearest CLIGEN station. In early attempts to develop customized climates, a
set of instructions was developed describing how to modify the parameter file to better match the desired
climate. This arduous process involved changing statistics in the fixed-format parameter file, and proved to be
too difficult for most users. A new interface was developed, which, as a minimum, allowed users to enter the
average monthly precipitation amounts. Users can either change individual monthly values, or specify a percent
increase or decrease to be applied across the year. If they have the data, users can specify the number of wet
days in a month, and the average monthly maximum and minimum temperatures.
The values for the number of wet days in each month are used as an input value to obtain the wet day
probabilities for the climate station. CLIGEN requires the probability of a wet day following a wet day
<i>(P(W|W))</i> and the probability of a wet day following a dry day <i>(P(W|D)).</i> For our interface, the number of wet
days is used because it is more readily available. The probability of a wet day in a given month, <i>P(W),</i> can be
calculated by dividing the number of wet days by the number of days in the month. The relationship between
the three probabilities is:
   <blockquote>
   <table border=0 width="90%">
    <tr>
     <td><i>P(W) = P(W) P(W|W) + (1 - P(W)) P(W|D)</i></td>
     <td align="right">(1)</td>
    </tr>
   </table>
   </blockquote>
Equation 1 can be solved for any of the three variables, so if two are known or assumed, the third can be calculated.
As the CLIGEN parameter file requires <i>P(W|W)</i> and <i>P(W|D),</i> and the user provides only <i>P(W),</i>
some assumptions were necessary about the relationship between <i>P(W|W)</i> and <i>P(W|D).</i>
Geng et al. (1986) have recommended using:
   <blockquote>
   <table border=0 width="90%">
    <tr>
     <td><i>P(W|D) = 0.75 P(W)</i></td>
     <td align="right">(2)</td>
    </tr>
   </table>
   </blockquote>
so
   <blockquote>
   <table border=0 width="90%">
    <tr>
     <td><i>P(W|W) = 0.25 + P(W|D))</i></td>
     <td align="right">(3)</td>
    </tr>
   </table>
   </blockquote>
However, the result of using these two equations is a value of <i>P(W/W)</i> always greater than 0.25, which from
the CLIGEN data set is not always true, especially in the drier climates.
 Other attempts to fix the value for either
<i>P(W|W)</i> or <i>P(W|D)</i> were found to be unsatisfactory as the values could result in negative probabilities in
drier climates, or probabilities greater than one in wetter climates.
 To overcome these problems, the ratio of
<i>P(W|D):P(W|W)</i> was determined from the nearby CLIGEN parameter file, and that ratio combined with the
user's value for <i>P(W)</i> to derive <i>P(W|W)</i> and <i>P(W|D)</i> for the desired climate. Substituting <i>Ratio</i> for
<i>P(W|D)/P(W|W)</i> in equation 1 and rearranging then gives:
   <blockquote>
   <table border=0 width="90%">
    <tr>
     <td><i>P(W|W) = 1/(1 - Ratio + (Ratio / P(W)))</i></td>
     <td align="right">(4)</td>
    </tr>
   </table>
   </blockquote>
and
   <blockquote>
   <table border=0 width="90%">
    <tr>
     <td><i>P(W|D) = P(W|W) * Ratio</i></td>
     <td align="right">(5)</td>
    </tr>
   </table>
   </blockquote>
The new interface incorporates the option to modify temperatures by lapse rate. The lapse rates were
specified as 6<sup>o</sup>C/km for maximum temperature and 5<sup>o</sup>C/km for minimum temperature. These values are
comparable to 4.8 to 6.8<sup>o</sup>C/km found by Johnson et al. (1998) and the average 6<sup>o</sup>C/km given by Trewartha and
Horn (1980). Generally, minimum temperature lapse rates are not as great as maximum rates because of
temperature inversions that can occur during the evenings or during very cold winter days.

<h3>PRISM</h3>
The PRISM (Parameter-Regressions on Independent Slopes Model) database was developed cooperatively
by the USDA-NRCS and ARS, and Oregon State University (Daly et al., 1997). The database contains the
average monthly precipitation values and average elevations for a 2.5-min. grid covering the entire continental
U.S. It was developed by interpolating and extrapolating precipitation amounts between weather stations.
Factors to allow for elevation, aspect, and other local effects were considered in the development. Numerous
state climatologists have reviewed the PRISM database, and their observations have been incorporated into it.
Figures 1 and 2 present some typical results in monthly precipitation distributions for Moscow, ID, and
Cowetta, NC. The database was installed on our file servers, and an interface was developed to aid in finding
the desired grid on the database.


<h3>Interface</h3>
We are developing Internet interfaces for the WEPP model (https://forest.moscowfsl.wsu.edu/fswepp) (Elliot
et al. 2000). Included in these WEPP interfaces is one that allows the selection and modification of climates for
use within the interfaces, and another for generating and downloading climates for use with either the MS DOS
or Windows versions of the WEPP model. The interface called Rock Clime is a series of web pages to aid the
user in selecting a state, and then a climate station. The user can then modify the monthly precipitation amounts
manually or with the aid of PRISM. He or she can allow the interface to adjust the maximum and minimum
temperatures by a lapse rate, or manually specify the monthly values. Figure 3 shows the web page where the
manual adjustments are made, and figure 4, the page where the PRISM grid can be selected.
<br><br><center>
<img src="images/fig1_2.gif">
</center><br><br>
<center>
<img src="images/fig3_4.gif">
</center><br><br>

<h3>Summary</h3>
To better predict soil erosion, this paper described corrections made to the CLIGEN database. It then
presented the assumptions necessary to allow users to generate a custom climate, including estimations of the
probabilities associated with a wet day and lapse rates for temperature adjustments. The PRISM precipitation
database was also incorporated into the technology, and a series of Internet web pages was developed to link the
enhanced climate database to either standalone versions of the WEPP model, or to the Forest Service Internet
WEPP interface.

<h3>References</h3>
Daly, C., G. Taylor, and W. Gibson. 1997. <i>The PRISM Approach to Mapping Precipitation and Temperature.</i>
<b>Proc. 10th Conf. on Applied Climatology,</b> Reno, NV, Amer. Meteor. Soc., 10-12.<br>
<br>
Elliot, W. J., D. L. Scheele, and D. E. Hall. 2000. <i>The Forest Service WEPP interfaces.</i> Presented at the
<b>2000 ASAE Summer Meeting,</b> Paper No. 00-5021. St. Joseph, MI: ASAE. 9 pp.<br>
<br>
Flanagan, D. C., and S. J. Livingston (eds.). 1995. <b>WEPP User Summary.</b> NSERL Report No. 11, W. Lafayette, IN:
National Soil Erosion Research Laboratory. 131 pp.<br>
<br>
Geng, S., F. W. T. Penning de Vries, and I. Supit. 1986. <i>A simple method for generating rainfall data.</i>
<b>Agricultural and Forest Meteorology</b> 36:363-376.<br>
<br>
Johnson, G. L., C. Daly and C. L. Hanson. 1998. <i>Weather generator parameter spatial variability and mapping.</i>
Presented at <b>1998 ASAE Annual International Meeting,</b> Orlando, Florida, July 12-16. Paper No. 98-2006.
St. Joseph, MI: ASAE. 5 pp.<br>
<br>
Nicks, A. D., L. J. Lane, and G. A. Gander. 1995. <i>Chapter 2: Weather Generator.</i> In Flanagan and Nearing,
<b>USDA-Water Erosion Prediction Project Hillslope Profile and Watershed Model Documentation.</b> 2.1-2.22.<br>
<br>
Trewartha, G. T., and L. H. Horn. 1980. <b>An Introduction to Climate.</b> New York: McGraw-Hill Book Co. pp 56-57.<br>
<br>
Western Regional Climate Center (WRCC). 1991. <i>"Old NCDC Cooperative Observer Network Inventory."
WRCC -- Active Coop Station Data Inventory Listings.</i>
Available online at &lt;https://www.wrcc.dri.edu/inventory/inventact.html&gt;<br>
<br>
  <hr>
  <b>Originally published as:</b>
  <blockquote>
   Scheele, D.L; Elliot, W.J.; Hall, D.E. 2001.
   <i>Enhancements to the CLIGEN Weather Generator for Mountainous or Custom Applications.</i>
   In: J.C. Ascough II and D.C. Flanagan, eds., <b>Soil Erosion Research for the 21<sup>st</sup> Century,</b>
   Proc. Int. Symp. (3-5 January 2001, Honolulu, HI, USA).
   St. Joseph, MI: ASAE. pp. 392-395
  </blockquote>
  <hr>
  USDA Forest Service, Rocky Mountain Research Station, Moscow Forestry Sciences Laboratory
  <br>
  <a href="https://forest.moscowfsl.wsu.edu/">https://forest.moscowfsl.wsu.edu/</a>
 </body>
</html>
